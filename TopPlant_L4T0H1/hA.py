from numpy import *
import scipy

def hA(x,a,u,d,p,nn):
    u1=u[0] 
    u3=u[2] 
    u4=u[3] 
    u5=u[4] 
    u6=u[5] 
    u7=u[6] 
    u8=u[7] 
    u9=u[8] 
    u10=u[9] 
    u12=u[11] 
    u13=u[12] 
    u14=u[13] 
    u15=u[14] 
    u16=u[15] 
    u18=u[17] 
    u19=u[18] 
    u20=u[19] 
    u21=u[20] 
    u22=u[21] 
    u24=u[23] 
    u25=u[24] 
    u26=u[25] 
    u27=u[26] 
    u28=u[27] 
    u30=u[29] 
    u31=u[30] 
    u32=u[31] 
    u33=u[32] 
    u34=u[33] 
    u35=u[34] 
    u36=u[35] 
    u37=u[36] 
    u38=u[37] 
    u39=u[38] 
    d1=d[0] 
    p1=p[0] 
    p3=p[2] 
    p4=p[3] 
    p5=p[4] 
    p6=p[5] 
    p7=p[6] 
    p8=p[7] 
    p9=p[8] 
    p10=p[9] 
    p12=p[11] 
    p13=p[12] 
    p14=p[13] 
    p15=p[14] 
    p16=p[15] 
    p18=p[17] 
    p19=p[18] 
    p20=p[19] 
    p21=p[20] 
    p22=p[21] 
    p24=p[23] 
    p25=p[24] 
    p26=p[25] 
    p27=p[26] 
    p28=p[27] 
    p30=p[29] 
    p31=p[30] 
    p32=p[31] 
    p33=p[32] 
    p34=p[33] 
    p35=p[34] 
    p36=p[35] 
    p37=p[36] 
    p38=p[37] 
    p39=p[38] 
     
    M = zeros((nn,8,8)) 
     
    M[:,0,0] = - 3500*p1*u1 - 1000 
    M[:,1,1] = - 3500*d1 - 1000 
    M[:,0,2] = 3500*p35*u35 
    M[:,2,2] = - 3500*p12*u12 - 3500*p18*u18 - 3500*p24*u24 - 3500*p30*u30 - 3500*p35*u35 - 1000 
    M[:,4,2] = 3500*p12*u12 
    M[:,5,2] = 3500*p18*u18 
    M[:,6,2] = 3500*p24*u24 
    M[:,7,2] = 3500*p30*u30 
    M[:,3,3] = - 3500*p13*u13 - 3500*p19*u19 - 3500*p25*u25 - 3500*p31*u31 - 1000 
    M[:,4,3] = 3500*p13*u13 
    M[:,5,3] = 3500*p19*u19 
    M[:,6,3] = 3500*p25*u25 
    M[:,7,3] = 3500*p31*u31 
    M[:,0,4] = 3500*p36*u36 
    M[:,2,4] = 3500*p3*u3 
    M[:,3,4] = 3500*p7*u7 
    M[:,4,4] = - 3500*p3*u3 - 3500*p7*u7 - 3500*p20*u20 - 3500*p26*u26 - 3500*p32*u32 - 3500*p36*u36 - 2000 
    M[:,5,4] = 3500*p20*u20 
    M[:,6,4] = 3500*p26*u26 
    M[:,7,4] = 3500*p32*u32 
    M[:,0,5] = 3500*p37*u37 
    M[:,2,5] = 3500*p4*u4 
    M[:,3,5] = 3500*p8*u8 
    M[:,4,5] = 3500*p14*u14 
    M[:,5,5] = - 3500*p4*u4 - 3500*p8*u8 - 3500*p14*u14 - 3500*p27*u27 - 3500*p33*u33 - 3500*p37*u37 - 2000 
    M[:,6,5] = 3500*p27*u27 
    M[:,7,5] = 3500*p33*u33 
    M[:,0,6] = 3500*p38*u38 
    M[:,2,6] = 3500*p5*u5 
    M[:,3,6] = 3500*p9*u9 
    M[:,4,6] = 3500*p15*u15 
    M[:,5,6] = 3500*p21*u21 
    M[:,6,6] = - 3500*p5*u5 - 3500*p9*u9 - 3500*p15*u15 - 3500*p21*u21 - 3500*p34*u34 - 3500*p38*u38 - 2000 
    M[:,7,6] = 3500*p34*u34 
    M[:,0,7] = 3500*p39*u39 
    M[:,2,7] = 3500*p6*u6 
    M[:,3,7] = 3500*p10*u10 
    M[:,4,7] = 3500*p16*u16 
    M[:,5,7] = 3500*p22*u22 
    M[:,6,7] = 3500*p28*u28 
    M[:,7,7] = - 3500*p6*u6 - 3500*p10*u10 - 3500*p16*u16 - 3500*p22*u22 - 3500*p28*u28 - 3500*p39*u39 - 2000 
    
    M = scipy.linalg.block_diag(*M)
    
    return M 
